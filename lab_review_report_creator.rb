require 'csv' 

table = CSV.table('ql-reviews-report-1530727477.csv')

gcp_keywords = {
    classroom: ["Apigee and GCP APIJam", "Apigee Event 2018", "Apigee Istio Workshop", "Architecting with Google Cloud Platform: Design and Process", "Architecting with Google Cloud Platform: Infrastructure", "Architecting with Google Cloud Platform: Infrastructure (Coursera)", "AWS Educate Starter Account 100", "AWS Educate Starter Account 150", "AWS Educate Starter Account 30", "AWS Educate Starter Account 30 - 2", "AWS Educate Starter Account 40", "AWS Educate Starter Account 50", "AWS Educate Starter Account 75", "Baseline: Data, ML, AI Quest", "Big Data & ML Fundamentals (Coursera) v1.1", "Big Data and Machine Learning Fundamentals (v1.1)", "Cloud Architecture", "Cloud Practitioner Labs (Educators Version)", "Codelabs: Self-Paced @ Next '17 -- Additional", "Coursera Course 1 - Final", "Coursera Google Cloud Platform Fundamentals: Core Infrastructure", "Data Engineering on Google Cloud Platform v1.1", "Data Engineering on Google Cloud Platform v1.2", "Data Engineering Quest", "Dataproc + Dataprep", "Questless Self-paced Labs", "Deploying Applications", "Deployment Manager Quest", "Developing and Deploying Windows Workloads on GCP", "Developing Applications with Google Cloud Platform", "EDit Coursera Course 1 Lab 1", "EDit Coursera Course 1 Lab 2", "EDit Coursera Course 1 Lab 3", "EDit Coursera Course 1 Lab 4", "EDit Coursera Course 3 Lab 1", "EDit Coursera Course 3 Lab 10", "EDit Coursera Course 3 Lab 11", "EDit Coursera Course 3 Lab 12", "EDit Coursera Course 3 Lab 2", "EDit Coursera Course 3 Lab 3", "EDit Coursera Course 3 Lab 4", "EDit Coursera Course 3 Lab 5", "EDit Coursera Course 3 Lab 6", "EDit Coursera Course 3 Lab 7", "EDit Coursera Course 3 Lab 8", "EDit Coursera Course 3 Lab 9", "EDit Coursera Course 5 Lab 1", "EDit Coursera Course 5 Lab 2", "EDit Coursera Course 5 Lab 3", "EDit Coursera Course 5 Lab 4", "EDit Coursera Course 5 Lab 5", "EDit Coursera Course 5 Lab 6", "EDit Coursera Course 5 Lab 7", "EDit Coursera Course 6 Lab 1", "EDit Coursera Course 6 Lab 2", "EDit Coursera Course 6 Lab 3", "From Data to Insights with Google Cloud Platform", "From Data to Insights with Google Cloud Platform (Coursera)", "GCP Essentials Quest", "Getting Started with Google Kubernetes Engine", "Getting Started with Kubernetes and Google Container Engine", "Getting Started with Kubernetes and Google Container Engine (Coursera)", "Google Cloud Platform Fundamentals for AWS Professionals", "Google Cloud Platform Fundamentals: Core Infrastructure", "Google Cloud Solutions I: Scaling Your Infrastructure Quest", "Google Cloud Solutions II: Data and Machine Learning", "Kubernetes in the Google Cloud Quest", "Machine Learning APIs Quest", "ML on GCP [Coursera] - How Google Does ML", "ML on GCP [Coursera] 2 - Launching into Machine Learning", "ML on GCP [Coursera] 3 - Introduction to TensorFlow", "ML on GCP [Coursera] 4 - Feature Engineering", "ML on GCP [Coursera] 5 - Art and Science of ML", "Networking in the Google Cloud", "Postgres Conference 2018", "Qwik Starts and Challenge Labs", "Recommendations with TensorFlow", "Scientific Data Processing on the Google Cloud Platform", "Serverless Machine Learning with TensorFlow on GCP [Coursera]", "Stackdriver GCP Quest", "Tensorflow and Deep Learning, Without a PhD ", "Veritas CloudPoint Deployment", "Websites and Web Applications Quest"],
    lab: ["Build and Launch an ASP.NET Core App from Google Cloud Shell", "Deploy Windows Server with ASP.NET Framework to Compute Engine", "Deploy an ASP.NET Core App to App Engine", "Deploy Microsoft SQL Server to Compute Engine", "Deploy ASP.NET Core App to Kubernetes Engine", "Monitoring Cloud Infrastructure with Stackdriver", "Configuring and Deploying Windows SQL Server on GCP", "Running Windows Containers on Compute Engine", "App Engine: Qwik Start - Ruby", "Using Ruby on Rails with Cloud SQL for PostgreSQL", "Deploy Refinery CMS to App Engine Flexible Environment", "Web App to Perform Real-time Data Analysis with Kubernetes, Redis, and BigQuery", "Deploying Veritas CloudPoint on Google Cloud Platform", "Tensorflow and deep learning, without a PhD labs: cloud steps", "Application Performance Management (APM) with Stackdriver", "Customizing Stackdriver Logs for Kubernetes Engine with Fluentd", "Autoscaling an Instance Group with Stackdriver Custom Metrics", "Creating and Alerting on Logs-based Metrics", "Monitoring and Logging for Cloud Functions", "Monitoring Multiple Cloud Projects with Stackdriver", "Serverless Machine Learning - Lab 1 : Create ML datasets (v1.2)", "Serverless Machine Learning - Lab 2: Getting Started with TensorFlow (v1.2)", "Serverless Machine Learning - Lab 5: Distributed training and monitoring (v1.2)", "Serverless Machine Learning - Lab 6: Scaling up ML using Cloud ML Engine (v1.2)", "Serverless Machine Learning - Lab 4: Refactoring to add batching and feature-creation v1.2", "Serverless Machine Learning - Lab 7: Feature Engineering (v1.2)", "Serverless Machine Learning - Lab 3: Machine Learning using tf.estimator (v1.2)", "Weather Data in BigQuery", "Analyzing Natality Data Using Datalab and BigQuery", "Rent-a-VM to Process Earthquake Data", "Predicting Baby Weight with TensorFlow on Cloud ML Engine", "Distributed Image Processing in Cloud Dataproc", "Distributed Computation of NDVI from Landsat Images Using Cloud Dataflow", "Image Classification of Coastline Images Using TensorFlow on Cloud ML Engine", "Recommendations with TensorFlow Part 1", "Recommendations with TensorFlow Part 2", "Recommendations with TensorFlow Part 3", "Recommendations with TensorFlow Part 4", "Cloud Storage: Qwik Start - Console", "Dataproc: Qwik Start - Console", "Cloud Storage: Qwik Start - CLI/SDK", "Google Cloud SDK: Qwik Start - Redhat/Centos", "Cloud IAM: Qwik Start", "Kubernetes Engine: Qwik Start", "Video Intelligence: Qwik Start", "Cloud Functions: Qwik Start - Console", "Cloud Functions: Qwik Start - Command Line", "App Engine: Qwik Start - Java", "Cloud Source Repositories: Qwik Start", "Container-Optimized OS: Qwik Start", "Datastore: Qwik Start", "Cloud SQL for PostgreSQL: Qwik Start", "Cloud Spanner: Qwik Start", "Data Loss Prevention: Qwik Start - JSON", "Cloud Security Scanner: Qwik Start", "Internet of Things: Qwik Start", "BigQuery: Qwik Start - Web User Interface", "Bigtable: Qwik Start - Hbase Shell", "Bigtable: Qwik Start - Command Line", "Cloud Natural Language API: Qwik Start", "Google Cloud Speech API: Qwik Start", "Container Registry: Qwik Start", "Dataprep: Qwik Start", "Google Cloud Pub/Sub: Qwik Start - Console", "Dataproc: Qwik Start - Command Line", "Google Cloud Datalab: Qwik Start", "Data Studio: Qwik Start", "Google Genomics: Qwik Start", "Google Cloud Pub/Sub: Qwik Start - Command Line", "App Engine: Qwik Start - Python", "BigQuery: Qwik Start - Command Line", "App Engine: Qwik Start - Go", "Data Loss Prevention: Qwik Start - Command Line", "App Engine: Qwik Start - PHP", "Cloud SQL for MySQL: Qwik Start", "Google Cloud Essential Skills: Challenge Lab", "Cloud Endpoints: Qwik Start", "Building an IoT Analytics Pipeline on Google Cloud Platform", "Terraform Fundamentals", "Getting Started with Cloud KMS", "TensorFlow for Poets", "Structured Data Regression with Cloud ML Engine & Datalab via Cloud Shell", "Setting up a Minecraft Server on Google Compute Engine", "Introduction to Cloud Dataproc: Hadoop and Spark on Google Cloud Platform", "Speaking with a Webpage - Streaming Speech Transcripts", "Google Maps Web Services Proxy for Mobile Applications", "Mapping the NYC Subway", "High Availability PostgreSQL and Kubernetes with Google Cloud", "Networking 101", "Networking 102", "Network Performance Testing", "Internal Load Balancer", "Building High-throughput VPN", "Improving Network Performance I", "Creating Cross-region Load Balancing", "HTTP Load Balancer", "Improving Network Performance II", "[ML on GCP C5 v1.0] Improve model accuracy by hand-tuning hyperparameters", "[ML on GCP C5 v1.0] Improve model accuracy by hyperparameter tuning with Cloud MLE", "[ML on GCP C5 v1.0] Using Neural Networks to build ML model", "[ML on GCP C5 v1.0] Using Custom Estimators", "ML on GCP [v1.0] - C4 - Improving model accuracy with new features", "ML on GCP [v1.0] - C4 - A simple Dataflow pipeline (Python)", "ML on GCP [v1.0] - C4 - MapReduce in Dataflow (Python)", "ML on GCP [v1.0] - C4 - Computing Time-Windowed Features in Cloud Dataprep", "ML on GCP [v1.0] - C4 - Improve ML model with Feature Engineering", "ML on GCP [v1.0] - C4 - Exploring tf.transform", "ML on GCP [v1.0] - C3 - Scaling TensorFlow with Cloud MLE", "ML on GCP [v1.0] - C3 - Scaling up TensorFlow ingest using batching", "ML on GCP [v1.0] - C3 - Creating a distributed training TensorFlow model with Estimator", "ML on GCP [v1.0] - C3 - Writing low-level TensorFlow programs", "ML on GCP [v1.0] - C3 - Implementing a Machine Learning model in TensorFlow", "ML on GCP [v1.0] - C2 - Creating repeatable splits in BigQuery", "ML on GCP [v1.0] - C2 - Exploring and Creating ML Datasets", "ML on GCP [v1.0] - C1 - Rent-a-VM to process earthquake data", "ML on GCP [v1.0] - C1 - Invoking Machine Learning APIs", "ML on GCP [v1.0] - C1 - Analyzing data using Datalab and BigQuery", "ML on GCP [v1.0] - C1 - Getting Started with Qwiklabs", "Classify Text into Categories with the Natural Language API", "Extract, Analyze, and Translate Text from Images with the Cloud ML APIs", "Implementing an AI Chatbot with Dialogflow", "Awwvision: Cloud Vision API from a Kubernetes Cluster", "Cloud ML Engine: Qwik Start", "Detect Labels, Faces, and Landmarks in Images with the Cloud Vision API", "Entity and Sentiment Analysis with the Natural Language API", "Hello Node Kubernetes", "Managing Deployments Using Kubernetes Engine", "Continuous Delivery with Jenkins in Kubernetes Engine", "Orchestrating the Cloud with Kubernetes", "Introduction to Docker", "Running a MongoDB Database in Kubernetes with StatefulSets", "Helm Package Manager", "Build a Slack Bot with Node.js on Kubernetes", "Exploring NCAA Data with BigQuery", "Creating Custom Interactive Dashboards with Bokeh and BigQuery", "Running R at Scale on Google Compute Engine", "Creating an Object Detection Application Using TensorFlow", "Running Distributed TensorFlow on Compute Engine", "Using Distributed TensorFlow with Cloud ML Engine and Cloud Datalab", "Using OpenTSDB to Monitor Time-Series Data on Cloud Platform", "Scanning User-generated Content Using the Cloud Video Intelligence and Cloud Vision APIs", "Deploying Memcached on Kubernetes Engine", "Hello Istio with Kubernetes Engine", "Continuous Delivery Pipelines with Spinnaker and Kubernetes Engine", "Setting up Jenkins on Kubernetes Engine", "Running Dedicated Game Servers in Google Kubernetes Engine", "Building High Availability and High Bandwidth NAT Gateways", "Deploying a Fault-Tolerant Microsoft Active Directory Environment", "Getting Started with Cloud Launcher", "Getting Started with Compute Engine", "Getting Started with Cloud Storage and Cloud SQL", "Getting Started with Kubernetes Engine", "Getting Started with App Engine", "Getting Started with Deployment Manager and Google Stackdriver", "Getting Started with BigQuery", "Networking", "VM Instances", "Storage as a Service", "Database as a Service", "Custom Networks", "Scaling and Load Balancing", "Deployment and Management", "Introduction to Containers and Docker", "Deploying to Kubernetes", "Continuous deployment with Jenkins", "Kubernetes Basics", "Qwiklabs Access v2", "Stackdriver: Qwik Start", "Set Up Network and HTTP Load Balancers", "Compute Engine: Qwik Start - Windows", "Provision Services with Cloud Launcher", "Creating a Virtual Machine", "Creating a Persistent Disk", "Getting Started with Cloud Shell & gcloud", "Data to Insights:  [v1.0]: M05 L4ab: Transforming Data with Cloud Dataprep", "Data to Insights:  [v1.0]: M02 L1: Exploring your Public Dataset with Google BigQuery", "Data to Insights:  [v1.0]: M00 L0: Setting up Qwiklabs", "Data to Insights:  [v1.0]: M03 L2: Troubleshoot Common SQL Errors with BigQuery", "Data to Insights:  [v1.0]: M08 L7: Exploring a Dataset in Google Data Studio", "Data to Insights:  [v1.0]: M09 L8: UNIONING and JOINING Datasets", "Data to Insights:  [v1.0]: M13 L11: Optimizing and Troubleshooting Query Performance", "Data to Insights:  [v1.0]: M10 L9: Advanced Functions and Clauses", "Data to Insights:  [v1.0]: M11 L10: Practicing Querying Nested and Repeated Fields", "Data to Insights:  [v1.0]: M04 L3: Calculate Google BigQuery Pricing", "Data to Insights: [v1.0]: M17 L17 Practice with ML APIs in Cloud Datalab", "Data to Insights:  [v1.0]: M06 L5: Creating new Permanent Tables", "Data to Insights:  [v1.0]: M07 L6: Ingesting and Querying New Datasets", "Data to Insights: [v1.0]: M16 L16 Connecting BigQuery to Cloud Datalab", "Data to Insights: [v1.0]: M18 L18 End-to-End ML Practice with ML Toolbox", "Data to Insights with Google Cloud Platform", "Introducing tcpdump", "Hands on with Hashing", "Create/inspect key pair, encrypt/decrypt and sign/verify using OpenSSL", "Set up a Monitored Web Cluster From Scratch", "Monitoring Apache with Prometheus", "Monitoring Basics with Prometheus", "Use Chef to Automate Infrastructure Management", "Explore an Existing Git Repository", "Course 5 Module 4 Lab 1", "Reading Web Server Logs", "Create, Modify and Remove Files and Folders in Linux", "Use Logs to Help You Track Down an Issue in Windows", "C3M6.1: Using Logs on Linux", "Maintaining Efficient Process Utilization on Windows", "C3M5.1: Maintaining Efficient Process Utilization on Linux", "Software Packages and File Archives on Windows", "Software Packages and File Archives on Linux", "Create, Modify, and Remove File and Folder Permissions in Windows", "Partition and Format a Disk Drive in Windows", "Partition and Format a Disk Drive in Linux", "Create, Modify, and Remove Files and Folders in Windows", "C3M2.1: Create, Modify, and Remove File and Folder Permissions in Linux", "Install, Update, and Remove Software in Windows", "Install, Update and Remove Software in Linux", "Create a Folder with Windows", "C1M3.1: Create a Folder with Linux", "Migration Workshop – DMS Lab (Oracle-Aurora)", "App Dev: Deploying an API for the Quiz Application", "App Dev: Deploying the Application into Container Engine", "App Dev: Setting up a Development Environment", "App Dev: Storing Application Data in Cloud Datastore", "App Dev: Developing a Backend Service", "App Dev: Processing Cloud Pub/Sub Data using Cloud Functions", "App Dev: Adding User Authentication to your Application", "App Dev: Deploying the Application into App Engine Flexible Environment", "App Dev: Debugging Application Errors", "App Dev: Harnessing Stackdriver Trace and Monitoring", "App Dev: Instructor Demo Environment", "App Dev: Storing Image and Video Files in Cloud Storage", "Load Balance an ASP.NET Application", "Create an ASP.NET MVC Web Application", "Create a highly available SQL Server backend using AlwaysOn Availability Groups", "Create a Windows Virtual Machine in Google Compute Engine", "Deploy an ASP.NET Core app to App Engine", "Create a Cloud SQL Instance Using Deployment Manager", "Deployment Manager - Adding Load Balancing", "Configuring Deployment Manager Templates", "Deployment Manager: Qwik Start", "Deployment Manager - Full Production", "Create a Network Load-Balanced Logbook Application", "Deployment Manager for Appserver", "Deployment Manager - Package and Deploy", "Create a Custom Network Using Deployment Manager", "Deploying a Python Flask Web Application to App Engine Flexible", "Running WordPress on App Engine Flexible Environment", "Deploy Node.js Express Application in App Engine", "Firebase Web", "Firebase SDK for Cloud Functions", "Deploy a Ruby on Rails App to App Engine Flexible Environment", "Batch Load Data Into BigQuery", "Create a Basic Deployment Manager Template", "Customize Network Topology with Subnetworks", "G Suite Admin Getting Started: Personalization", "Getting Started with App Engine (Coursera)", "Getting Started with BigQuery (Coursera)", "Getting Started with Cloud Launcher (Coursera)", "Getting Started with Cloud Storage and Cloud SQL (Coursera)", "Getting Started with Compute Engine (Coursera)", "Getting Started with Deployment Manager and Stackdriver (Coursera)", "Image Classification With Cloud ML Engine & Datalab via Cloud Shell", "Installing a Monitoring Agent", "NGINX Ingress Controller on Google Kubernetes Engine", "Provisioning and Using a Managed Hadoop/Spark Cluster with Cloud Dataproc (Command Line)", "Run a Big Data Text Processing Pipeline in Cloud Dataflow", "Running a Node.js Container in Kubernetes with Container Engine", "Running a Spark Application with OpenCV on Cloud Dataproc", "Serverless Machine Learning with Cloud ML Engine", "Setting up a Private Kubernetes Cluster", "Speech to Text Transcription with the Cloud Speech API", "Translate Text with the Cloud Translation API", "Using Apigee for API Management", "Using Google Stackdriver Debug, Traces, Logging and Logpoints", "Using the Natural Language API from Google Docs", "Using the Natural Language API with Ruby", "Working with Google Cloud Dataprep", "Python Data Pipeline: GCP", "Serverless Data Analysis with BigQuery v1.2", "Serverless Machine Learning v1.2", "Leveraging Unstructured Data v1.2", "Serverless Data Analysis with Dataflow (Python) v1.2", "Serverless Data Analysis with Dataflow  (Java) v1.2", "Streaming Data Processing v1.2", "Leveraging Unstructured Data", "Serverless Data Analysis (Java)", "Serverless Machine Learning", "Streaming Data Processing", "Serverless Data Analysis (Python)", "Getting Started with Kubernetes Engine (Coursera)", "Big Data & ML Fundamentals: Lab 1 (v1.1)", "Big Data & ML Fundamentals : Lab 2 (v1.1)", "Big Data & ML Fundamentals Lab 1 : Create a Compute Engine Instance v1.1", "Big Data & ML Fundamentals Lab 2 : Interact with Cloud Storage v1.1", "Big Data & ML Fundamentals Lab 3 : Setup Rentals Data in Cloud SQL v1.1", "Big Data & ML Fundamentals Lab 4 : Recommendations ML with Dataproc v1.1", "Big Data & ML Fundamentals Lab 5 : Create ML Dataset with BigQuery v1.1", "Big Data & ML Fundamentals Lab 6 : Carry out ML with TensorFlow v1.1", "Big Data & ML Fundamentals Lab 7 : Invoke Machine Learning APIs v1.1", "AWS Educate Starter Account 75", "AWS Educate Starter Account 50", "AWS Educate Starter Account 40", "AWS Educate Starter Account 30 - 2", "AWS Educate Starter Account 30", "AWS Educate Starter Account 150", "AWS Educate Starter Account 100", "Console and Cloud Shell", "Virtual Machine Automation and Load Balancing", "Working with Virtual Machines", "Virtual Networking", "Qwiklabs and Access to Google Cloud Platform", "Bastion Host", "Projects", "Autoscaling", "Cloud Storage", "Infrastructure Preview", "Cloud SQL", "Cloud Datastore", "Billing Administration", "Examining Billing data with BigQuery", "Creating Virtual Machines", "Google Cloud Platform API Infrastructure Automation", "Resource Monitoring (Stackdriver)", "Cloud IAM", "Kubernetes Load Balancing", "Virtual Private Networks (VPN)", "Error Reporting and Debugging (Stackdriver)", "Deployment Manager", "Dynamic VPN with Cloud Routers", "Deployment Manager - Beginning Appserver", "Welcome to Qwiklabs", "Deployment Manager - Full Production + (Stackdriver)", "Hello Istio (with Kubernetes)", "Introduction to Kubernetes Engine", "Install and Configure Istio", "Introduction to Apigee Edge", "Apigee: Using API Management with the Google Cloud Platform", "API Jam with Google Cloud", "API Jam - Apigee + GCP", "Install and Use Cloud Tools for PowerShell", "[Data to Insights C1 - 2.0] Explore your Ecommerce Dataset with SQL in Google BigQuery", "[Data to Insights C1 - 2.0] Troubleshooting Common SQL Errors with Google BigQuery", "App Dev - Deploying the Application into App Engine Flexible Environment - Java", "App Dev - Deploying the Application into Kubernetes Engine - Java", "App Dev-Adding User Authentication to your Application-Java", "App Dev: Deploying the Application into Kubernetes Engine - Python", "Big Data & ML Fundamentals : Lab 2 (v1.0.1)", "Big Data & ML Fundamentals Lab 1 : Create a Compute Engine Instance v1.2", "Big Data & ML Fundamentals Lab 7: Invoke Machine Learning APIs v1.2", "Big Data & ML Fundamentals: Lab 1", "Creating an Instance with Multiple Network Interfaces", "Dataflow: Qwik Start - Python", "Dataflow: Qwik Start - Templates", "Distributed Load Testing Using Kubernetes", "End to End Machine Learning with Tensorflow on GCP", "Evaluating a Data Model", "Exploratory Data Analysis using Google Cloud Datalab", "IAM Custom Roles", "Ingesting Data Into The Cloud", "Introduction to Kubeflow on Google Kubernetes Engine", "Loading Data into Google BigQuery for Exploratory Data Analysis", "Multi-cloud Pub/Sub", "Multi-cloud SNS", "Processing Data with Google Cloud Dataflow", "Serverless Data Analysis with BigQuery Lab 1 : Build a BigQuery Query", "Serverless Data Analysis with BigQuery Lab 2 : Loading and Exporting Data", "Serverless Data Analysis with BigQuery Lab 3: Advanced SQL Queries", "Serverless Data Analysis with Dataflow Lab 1 : A Simple Dataflow Pipeline (Java/Python)", "Serverless Data Analysis with Dataflow Lab 2 : MapReduce in Dataflow (Java/Python)", "Serverless Data Analysis with Dataflow Lab 3 : Side Inputs (Java/Python)", "Service Accounts and Roles: Fundamentals", "Visualize Real Time Geospatial Data with Google Data Studio", "Visualizing Data with Google Data Studio", "VPC Network Peering", "Exploring ​and ​Preparing ​your ​Data with BigQuery Lab 3"]
}


aws_keywords = {
    clasroom: [],
    lab:["Building Your First Amazon Virtual Private Cloud (VPC)", "Introduction to Amazon EC2", "Serverless Architectures using Amazon CloudWatch Events and Scheduled Events with AWS Lambda", "Working with Amazon Elastic Block Store (EBS)", "Performing a Basic Audit of your AWS Environment", "Introduction to Amazon EC2 Auto Scaling", "Bundling Amazon EBS-Backed AMIs", "Working with Elastic Load Balancing", "Introduction to Amazon ElastiCache", "Using Tableau Desktop with Amazon Redshift", "Introduction to Amazon Relational Database Service (RDS) (Windows)", "Introduction to AWS CloudFormation Designer", "Creating an Amazon Virtual Private Cloud (VPC) with AWS CloudFormation", "Working with AWS Elastic Beanstalk", "Introduction to Amazon ElastiCache with Windows Server", "Introduction to Elastic Load Balancing", "Serverless Web Apps using Amazon DynamoDB - Part 1", "Introduction to Amazon Elastic Container Service", "Using Open Data with Amazon S3", "Introduction to Amazon Elastic Block Store (EBS)", "Working with AWS CodeCommit", "Serverless Web Apps using Amazon DynamoDB - Part 2", "Introduction to AWS CloudFormation", "Working with Amazon Elastic Container Service", "Introduction to Amazon Relational Database Service (RDS) - SQL Server", "Serverless Web Apps using Amazon DynamoDB - Part 3", "Introduction to Amazon Relational Database Service (RDS) (Linux)", "Using AWS Lambda with Amazon CloudWatch and SNS to Implement a Slack Chat Bot", "Working with Amazon ElastiCache for Redis", "Introduction to Amazon Elastic Container Registry", "Introduction to Amazon Aurora", "Introduction to AWS OpsWorks", "Introduction to AWS Service Catalog", "Introduction to AWS CodeDeploy", "AWS Tools for Windows PowerShell: Getting Started", "Programming Amazon S3 with .NET", "Deploy an End-to-End IoT Application", "Introduction to AWS Application Discovery Service", "Working with AWS CodeCommit on Windows", "Creating Amazon EC2 Instances (for Linux)", "Creating Amazon EC2 Instances with Microsoft Windows", "Hosting WordPress Using Amazon S3", "Launching and Managing a Web Application with AWS CloudFormation", "Advanced Amazon Redshift: Table Layout and Schema Design", "Blue/Green Deployment Pattern with AWS Elastic Beanstalk", "Building Scalable Web Applications with AWS Elastic Beanstalk", "Microsoft ADFS and AWS IAM", "Exploring Google Ngrams with Amazon EMR", "Advanced Design Patterns using Amazon DynamoDB", "Working with Amazon Redshift", "Maintaining High Availability with Auto Scaling (for Linux)", "Advanced Amazon Redshift: Data Loading", "Visualizing Security Groups with Amazon Elasticsearch Service", "Monitoring Security Groups with Amazon CloudWatch Events", "Update Security Groups Automatically Using AWS Lambda", "Automating AWS Services with Scripting and the AWS CLI", "Caching Static Files with Amazon CloudFront", "Streaming Dynamic Content using Amazon CloudFront", "Using Windows Server Storage Spaces with Amazon EBS", "Deploy a Java EE Application on AWS Elastic Beanstalk Using Docker Containers", "Serverless Architectures with Amazon DynamoDB and Amazon Kinesis Streams with AWS Lambda", "Working with Amazon CloudFront for Dynamic Content Acceleration", "Using Amazon RDS for Applications", "Windows Server Website Hosting on AWS: Getting Started", "Programming AWS Lambda for Windows", "Working with Amazon Route 53 Traffic Flow", "Auditing Your Security with AWS Trusted Advisor", "Building a Media Sharing Website - Part 1: Media Upload", "Administering Amazon RDS for Microsoft SQL Server", "Monitoring Security Groups with AWS Config", "Using Dynamic Registration and Dashboards for Amazon EC2 Instances", "Building Search into your Applications with Amazon CloudSearch", "Deploy a .NET Sample Application Using AWS Elastic Beanstalk", "Installing Microsoft Dynamics CRM 2015 on AWS: Getting Started", "Programming Amazon SQS and Amazon SNS with .NET", "Using Windows PowerShell Desired State Configuration in AWS", "Introduction to AWS Identity and Access Management (IAM)", "Introduction to Amazon Virtual Private Cloud (VPC)", "Introduction to AWS Internet-of-Things (IoT)", "Introduction to Amazon CloudFront", "Introduction to AWS Lambda", "Introduction to Amazon API Gateway", "Introduction to Amazon Redshift", "Introduction to Amazon Kinesis Firehose", "Introduction to Amazon Simple Storage Service (S3)", "Introduction to Amazon Elastic File System (EFS)", "Challenge Lab", "Introduction to Amazon DynamoDB", "Introduction to Amazon Elasticsearch Service", "Introduction to Amazon Route 53", "Analyze Big Data with Hadoop", "Introduction to AWS Key Management Service", "Introduction to AWS Device Farm", "Introduction to Amazon Machine Learning", "Migration Workshop – DMS Lab", "[DEV] Introduction to AWS Database Migration Service", "Automated Video Editing with YOU as the Star!", "AWS Game Development - Cognito Identity", "Build a Serverless Text-to-Speech Application with Amazon Polly", "Build an AWS Lambda Function for an Alexa Skill (Amazon Echo)", "Building a Media Sharing Website - Part 2: Transcoding", "Building Real-Time Dashboards with Amazon Kinesis Dynamic Aggregators", "Building VPC, S3, EC2, and RDS Products with AWS Service Catalog", "Deploy Docker Compose Microservices to Amazon EC2 Container Service", "Deploying Java Apps on AWS Elastic Beanstalk", "EMR File System Client-side Encryption Using AWS KMS-managed Keys", "Enhancing Your Android Application Using AWS Mobile Services", "Introduction to Amazon Elastic Compute Cloud (EC2)", "Introduction to Amazon Elastic Compute Cloud (EC2) with Windows Server", "Introduction to Amazon Elastic MapReduce (EMR)", "Introduction to Amazon Virtual Private Cloud (VPC) with Windows Server", "Introduction to AWS Database Migration Service", "Introduction to AWS Elastic Beanstalk", "Introduction to EC2 Spot Instances", "Introduction to git and GitHub", "Launching GeoServer on AWS", "Managing IoT Sensor Data with Amazon ElastiCache for Redis", "Microsoft DirectAccess on AWS: Getting Started", "Parallel File Copy and Consolidation for Amazon S3", "Programming Amazon DynamoDB with .NET", "Programming AWS Security Token Service (STS) with .NET", "Serverless Architectures using Amazon S3 and Amazon SNS with AWS Lambda", "SQL Server in Amazon EC2: Getting Started", "Using AWS Elastic Beanstalk with .NET", "Using AWS Systems Manager for Microsoft System Center Virtual Machine Manager", "Working with Alexa: Build a Decision Tree Skill", "Working with Alexa: Build a Fact Skill", "Working with Alexa: Build a Flashcard Skill", "Working with Alexa: Build a How-To Skill", "Working with Alexa: Build a Trivia Skill", "Working with Amazon DynamoDB", "Working with AWS CloudFormation", "Working with AWS OpsWorks", "AWS Migration Hub - Track Migrations from a single location"]
}

gcp_keywords.each do |key, value|
  table.delete_if do |row|
    unless row[key].nil?
      string = row[key].downcase
      value.any? { |word| string.include?(word.downcase) }
    end
  end
end

# aws_keywords.each do |key, value|
#   table.delete_if do |row|
#     unless row[key].nil?
#       string = row[key].downcase
#       value.any? { |word| string.include?(word.downcase) }
#     end
#   end
# end


File.open('ql-aws-lab-usage-report-june-2018.csv', 'w') do |f|
  f.write(table.to_csv)
end
